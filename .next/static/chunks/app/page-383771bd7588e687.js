(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1499:(e,s,t)=>{Promise.resolve().then(t.bind(t,3669))},3669:(e,s,t)=>{"use strict";t.d(s,{ChatForm:()=>f});var r=t(5832),l=t(5540),a=t(3881),n=t(7468),o=t(5595),i=t(6420);let c=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,s)=>{let{className:t,variant:l,size:a,asChild:o=!1,...d}=e,m=o?n.DX:"button";return(0,r.jsx)(m,{className:(0,i.cn)(c({variant:l,size:a,className:t})),ref:s,...d})});d.displayName="Button";var m=t(8221);let h=l.forwardRef((e,s)=>{let{className:t,children:l,...a}=e;return(0,r.jsxs)(m.bL,{ref:s,className:(0,i.cn)("relative overflow-hidden",t),...a,children:[(0,r.jsx)(m.LM,{className:"h-full w-full rounded-[inherit]",children:l}),(0,r.jsx)(u,{}),(0,r.jsx)(m.OK,{})]})});h.displayName=m.bL.displayName;let u=l.forwardRef((e,s)=>{let{className:t,orientation:l="vertical",...a}=e;return(0,r.jsx)(m.VM,{ref:s,orientation:l,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...a,children:(0,r.jsx)(m.lr,{className:"relative flex-1 rounded-full bg-border"})})});function x(){return(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(h,{className:"h-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:{color:"#ECECEC"},children:"Appointments"}),(0,r.jsx)("p",{className:"text-sm",style:{color:"#BDBDBD"},children:"Schedule and manage your appointments"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"p-4 rounded-lg border border-gray-700/50",style:{background:"#303030"},children:(0,r.jsx)("p",{className:"text-sm",style:{color:"#ECECEC"},children:"No appointments scheduled"})}),(0,r.jsx)(d,{className:"w-full",style:{background:"#404040",color:"#ECECEC"},onClick:()=>{},children:"Schedule New Appointment"})]})]})})})}function g(){return(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(h,{className:"h-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:{color:"#ECECEC"},children:"Virtual Reality"}),(0,r.jsx)("p",{className:"text-sm",style:{color:"#BDBDBD"},children:"Explore VR experiences and sessions"})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-gray-700/50",style:{background:"#303030"},children:[(0,r.jsx)("h3",{className:"font-medium mb-2",style:{color:"#ECECEC"},children:"Relaxation Session"}),(0,r.jsx)("p",{className:"text-sm mb-4",style:{color:"#BDBDBD"},children:"Immersive meditation and relaxation experience"}),(0,r.jsx)(d,{className:"w-full",style:{background:"#404040",color:"#ECECEC"},onClick:()=>{},children:"Start Experience"})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-gray-700/50",style:{background:"#303030"},children:[(0,r.jsx)("h3",{className:"font-medium mb-2",style:{color:"#ECECEC"},children:"Therapy Space"}),(0,r.jsx)("p",{className:"text-sm mb-4",style:{color:"#BDBDBD"},children:"Virtual therapy environment"}),(0,r.jsx)(d,{className:"w-full",style:{background:"#404040",color:"#ECECEC"},onClick:()=>{},children:"Enter Space"})]})]})})]})})})}function p(){return(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(h,{className:"h-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",style:{color:"#ECECEC"},children:"Therapeutic Games"}),(0,r.jsx)("p",{className:"text-sm",style:{color:"#BDBDBD"},children:"Interactive games designed for therapeutic purposes"})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-gray-700/50",style:{background:"#303030"},children:[(0,r.jsx)("h3",{className:"font-medium mb-2",style:{color:"#ECECEC"},children:"Mindfulness Journey"}),(0,r.jsx)("p",{className:"text-sm mb-4",style:{color:"#BDBDBD"},children:"A calming adventure through peaceful landscapes"}),(0,r.jsx)(d,{className:"w-full",style:{background:"#404040",color:"#ECECEC"},onClick:()=>{},children:"Play Game"})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-gray-700/50",style:{background:"#303030"},children:[(0,r.jsx)("h3",{className:"font-medium mb-2",style:{color:"#ECECEC"},children:"Emotion Explorer"}),(0,r.jsx)("p",{className:"text-sm mb-4",style:{color:"#BDBDBD"},children:"Interactive game to explore and understand emotions"}),(0,r.jsx)(d,{className:"w-full",style:{background:"#404040",color:"#ECECEC"},onClick:()=>{},children:"Start Journey"})]})]})})]})})})}function f(){let{data:e}=(0,a.useSession)(),[s,t]=(0,l.useState)([]),[n,o]=(0,l.useState)(null),[i,c]=(0,l.useState)(""),[d,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)(!1),[f,y]=(0,l.useState)(""),[v,b]=(0,l.useState)(!1),[j,N]=(0,l.useState)("chat");(0,l.useEffect)(()=>{C()},[e]);let C=async()=>{try{let e=await fetch("/api/chats");if(!e.ok)throw Error("Failed to fetch sessions");let s=await e.json();if(Array.isArray(s)&&s.every(e=>e.id&&"string"==typeof e.title&&e.weekStart&&Array.isArray(e.messages)))t(s),s.length>0&&o(s[0]);else throw Error("Invalid sessions data format")}catch(s){console.error("Error fetching sessions:",s);let e={id:crypto.randomUUID(),title:"Nuevo Chat",weekStart:new Date,messages:[]};t([e]),o(e)}},w=async e=>{if(e.preventDefault(),!i.trim())return;let s=n;if(!s){let e={id:crypto.randomUUID(),title:"Nuevo Chat",weekStart:new Date,messages:[]};s=e,t(s=>[e,...s]),o(e)}let r={id:crypto.randomUUID(),role:"user",content:i},l=[...s.messages||[],r];if(o(e=>e?{...e,messages:l}:null),c(""),m(!0),"Nuevo Chat"===s.title&&0===s.messages.length){let e=i.split(" ").slice(0,3).join(" ");E(e.length>30?e.substring(0,30)+"...":e)}try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:s.id,messages:l})}),r=await e.json();if(!e.ok)throw Error("string"==typeof r.error?r.error:"Failed to get response");if(r.response&&s){let e={id:crypto.randomUUID(),role:"assistant",content:r.response.content},a={...s,messages:[...l,e]};o(a),t(e=>e.map(e=>e.id===a.id?a:e))}}catch(e){console.error("Chat Error:",e),o(e=>{if(!e)return null;let s={...e,messages:[...e.messages,{id:crypto.randomUUID(),role:"assistant",content:"Algo fall\xf3. Intente m\xe1s tarde."}]};return t(e=>e.map(e=>e.id===s.id?s:e)),s})}finally{m(!1)}},E=async e=>{if(!n){u(!1);return}try{let s=await fetch("/api/chats/".concat(n.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,messages:n.messages})});if(!s.ok)throw Error("Failed to update chat title");let r=await s.json(),l={...n,title:r.title};o(l),t(e=>e.map(e=>e.id===n.id?l:e))}catch(e){console.error("Error updating chat title:",e)}finally{u(!1)}},k=async e=>{try{if(!(await fetch("/api/chats/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete chat");t(s=>s.filter(s=>s.id!==e)),(null==n?void 0:n.id)===e&&o(s[1]||null)}catch(e){console.error("Error deleting chat:",e)}},D=e=>{N(e),b(!1)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex h-screen",style:{background:"#212121"},children:[(0,r.jsxs)("div",{className:"w-[260px] border-r border-opacity-20 border-gray-700",style:{background:"#171717"},children:[(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6 px-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold cursor-pointer",style:{color:"#ECECEC"},onClick:()=>{N("chat")},children:"Chats"}),(0,r.jsx)("button",{onClick:()=>{let e={id:crypto.randomUUID(),title:"Nuevo Chat",weekStart:new Date,messages:[]};t(s=>[e,...s]),o(e),N("chat")},className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors",style:{color:"#BDBDBD"},children:(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M12 4V20M4 12H20",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),(0,r.jsx)("div",{className:"space-y-1",children:s.map(e=>(0,r.jsxs)("div",{className:"flex items-center group",children:[(0,r.jsx)("button",{onClick:()=>o(e),className:"flex-1 text-left p-3 rounded-lg transition-all duration-200 hover:translate-x-1",style:{background:(null==n?void 0:n.id)===e.id?"rgba(48, 48, 48, 0.8)":"transparent",color:"#BDBDBD",boxShadow:(null==n?void 0:n.id)===e.id?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:(0,r.jsx)("span",{style:{color:(null==n?void 0:n.id)===e.id?"#ECECEC":"#B4B4B4"},children:e.title})}),(0,r.jsx)("button",{onClick:()=>k(e.id),className:"p-2 opacity-0 group-hover:opacity-100 hover:bg-gray-700/50 rounded-lg transition-all",style:{color:"#BDBDBD"},children:(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z",fill:"currentColor"})})})]},e.id))})]}),(0,r.jsx)("div",{className:"p-4 border-t border-gray-700/50",children:(0,r.jsxs)("button",{onClick:()=>(0,a.signOut)(),className:"w-full p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm flex items-center justify-center gap-2",style:{color:"#BDBDBD"},children:[(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Cerrar sesi\xf3n"]})})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col",style:{background:"#212121"},children:[n&&(0,r.jsxs)("div",{className:"p-3 border-b border-opacity-20 border-gray-700 flex justify-between items-center",children:[(0,r.jsx)("div",{className:"max-w-[48rem] mx-auto flex-1",children:h?(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),onBlur:()=>E(f),onKeyDown:e=>{"Enter"===e.key?E(f):"Escape"===e.key&&(u(!1),y(n.title))},className:"text-lg font-medium bg-transparent border-none focus:outline-none w-full",style:{color:"#ECECEC"},autoFocus:!0})}):(0,r.jsx)("h1",{className:"text-lg font-medium cursor-pointer hover:opacity-80",style:{color:"#ECECEC"},onClick:()=>{y(n.title),u(!0)},children:n.title})}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:()=>b(!v),className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors",style:{color:"#BDBDBD"},children:(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M12 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm7 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM5 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2z",fill:"currentColor"})})}),v&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-[#303030] ring-1 ring-black ring-opacity-5",children:(0,r.jsxs)("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[(0,r.jsx)("button",{onClick:()=>D("chat"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-700/50 transition-colors",style:{color:"#ECECEC"},role:"menuitem",children:"Chat"}),(0,r.jsx)("button",{onClick:()=>D("appointments"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-700/50 transition-colors",style:{color:"#ECECEC"},role:"menuitem",children:"Agendar Cita"}),(0,r.jsx)("button",{onClick:()=>D("vr"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-700/50 transition-colors",style:{color:"#ECECEC"},role:"menuitem",children:"VR"}),(0,r.jsx)("button",{onClick:()=>D("games"),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-700/50 transition-colors",style:{color:"#ECECEC"},role:"menuitem",children:"Juegos"})]})})]})]}),"chat"===j?(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(null==n?void 0:n.messages)&&n.messages.length>0?(0,r.jsx)("div",{className:"flex-1 flex flex-col",children:n.messages.map((e,s)=>(0,r.jsx)("div",{className:"w-full",style:{background:"user"===e.role?"#303030":"transparent"},children:(0,r.jsx)("div",{className:"max-w-[48rem] mx-auto p-4 md:p-6",children:(0,r.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-sm flex items-center justify-center shrink-0",children:"assistant"===e.role?(0,r.jsx)("div",{className:"bg-teal-600 w-full h-full flex items-center justify-center rounded-sm text-xs font-medium text-white",children:"AI"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center rounded-sm text-xs font-medium",style:{background:"#5C5C5C",color:"white"},children:"U"})}),(0,r.jsx)("div",{className:"flex-1 leading-6",style:{color:"white"},children:e.content})]})})},s))}):(0,r.jsx)("div",{className:"flex-1"}),d&&(0,r.jsx)("div",{style:{background:"transparent"},children:(0,r.jsx)("div",{className:"max-w-[48rem] mx-auto p-4 md:p-6",children:(0,r.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-sm flex items-center justify-center shrink-0",children:(0,r.jsx)("div",{className:"bg-teal-600 w-full h-full flex items-center justify-center rounded-sm text-xs font-medium text-white",children:"AI"})}),(0,r.jsx)("div",{style:{color:"white"},className:"flex-1",children:(0,r.jsx)("div",{className:"animate-pulse",children:"Pensando..."})})]})})})]}):(()=>{switch(j){case"appointments":return(0,r.jsx)(x,{});case"vr":return(0,r.jsx)(g,{});case"games":return(0,r.jsx)(p,{});default:return null}})(),(0,r.jsx)("div",{className:"px-4 pb-4",children:(0,r.jsx)("div",{className:"max-w-[48rem] mx-auto",children:(0,r.jsx)("form",{onSubmit:w,className:"relative",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2 p-2 w-full bg-[#303030] rounded-xl shadow-lg border border-gray-700/50",children:[(0,r.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),placeholder:"Pregunta lo que quieras",style:{color:"#ECECEC"},className:"w-full bg-transparent p-2 focus:outline-none text-sm min-h-[20px]",disabled:d}),(0,r.jsxs)("div",{className:"flex items-center gap-3 px-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>D("appointments"),className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm",style:{color:"#BDBDBD"},children:"Agendar Cita"}),(0,r.jsx)("button",{type:"button",onClick:()=>D("vr"),className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm",style:{color:"#BDBDBD"},children:"VR"}),(0,r.jsx)("button",{type:"button",onClick:()=>D("games"),className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors text-sm",style:{color:"#BDBDBD"},children:"Juegos"})]})]})})})})]})]})})}u.displayName=m.VM.displayName},6420:(e,s,t)=>{"use strict";t.d(s,{cn:()=>a});var r=t(6579),l=t(6794);function a(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.QP)((0,r.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[881,887,135,830,955,358],()=>s(1499)),_N_E=e.O()}]);